<!DOCTYPE html>
<!--[if lt IE 9 ]><html class="no-js oldie" lang="en"> <![endif]-->
<!--[if IE 9 ]><html class="no-js oldie ie9" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

<head>

    <!--- basic page needs
    ================================================== -->
    <meta charset="utf-8">
    <title>Chicago Real-Time Air Quality</title>
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- mobile specific metas
    ================================================== -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- CSS
    ================================================== -->
    <link rel="stylesheet" href="/css/base.css">
    <link rel="stylesheet" href="/css/vendor.css">
    <link rel="stylesheet" href="/css/main.css">

    <!-- script
    ================================================== -->
    <script src="/js/modernizr.js"></script>
    <script src="/js/pace.min.js"></script>

    <!-- favicons
    ================================================== -->
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="icon" href="favicon.ico" type="image/x-icon">

</head>

<body id="top">

    <!-- header
    ================================================== -->
    <header class="s-header">

        <div class="header-logo">
            <a class="site-logo" href="/index.html">
                <img src="/images/logo.png" alt="Homepage">
            </a>
        </div>

        <nav class="header-nav">

            <a href="#0" class="header-nav__close" title="close"><span>Close</span></a>

            <div class="header-nav__content">
                <h3>Navigation</h3>

                <ul class="header-nav__list">
                    <li class="current"><a href="/index.html" title="home">Home</a></li>
                    <li><a class="smoothscroll" href="#about" title="about">About</a></li>
                    <li><a class="smoothscroll" href="#articles" title="services">Documentation</a></li>
                    <li><a class="smoothscroll" href="#video" title="works">Video</a></li>
                    <li><a class="smoothscroll" href="#contact" title="contact">Contact</a></li>
                </ul>

                <p>Quick Menu</p>

                <ul class="header-nav__social">
                    <li>
                        <a href="https://www.facebook.com/mrkmantovani"><i class="fa fa-facebook" aria-hidden="true"></i></a>
                    </li>
                    <li>
                        <a href="https://www.linkedin.com/in/mirkomantovani/"><i class="fa fa-linkedin" aria-hidden="true"></i></a>
                    </li>
                    <li>
                        <a href="https://www.instagram.com/mirkomantovani/"><i class="fa fa-instagram" aria-hidden="true"></i></a>
                    </li>
                    <li>
                        <a href="https://play.google.com/store/apps/developer?id=Mirko+Mantovani"><i class="fa fa-android" aria-hidden="true"></i></a>
                    </li>
                    <li>
                        <a href="https://github.com/mirkomantovani"><i class="fa fa-github" aria-hidden="true"></i></a>
                    </li>
                </ul>

            </div> <!-- end header-nav__content -->

        </nav> <!-- end header-nav -->

        <a class="header-menu-toggle" href="#0">
            <span class="header-menu-text">Menu</span>
            <span class="header-menu-icon"></span>
        </a>

    </header> <!-- end s-header -->


    <!-- home
    ================================================== -->
    <section id="home" class="s-home target-section" data-parallax="scroll" data-image-src="/images/p3viz/cover.png" data-natural-width=3000 data-natural-height=2000 data-position-y=center>



        <div class="overlay"></div>

        <div class="shadow-overlay"></div>

        <div class="home-content">

            <div class="row home-content__main">

                <h3>Project page</h3>

                <h1>
                    Chicago Real-Time Air Quality, Visualization and Visual Analytics
                </h1>

                <div class="home-content__buttons">
                    <a href="#video" class="smoothscroll btn btn--stroke">
                        Video
                    </a>
                    <a href="#about" class="smoothscroll btn btn--stroke">
                        About
                    </a>
                </div>

            </div>

            <div class="home-content__scroll">
                <a href="#about" class="scroll-link smoothscroll">
                    <span>Scroll Down</span>
                </a>
            </div>

            <div class="home-content__line"></div>

        </div> <!-- end home-content -->


        <ul class="home-social">
            <li>
                <a href="https://www.facebook.com/mrkmantovani"><i class="fa fa-facebook" aria-hidden="true"></i><span>Facebook</span></a>
            </li>
            <li>
                <a href="https://www.linkedin.com/in/mirkomantovani/"><i class="fa fa-linkedin" aria-hidden="true"></i><span>LinkedIn</span></a>
            </li>
            <li>
                <a href="https://www.instagram.com/mirkomantovani/"><i class="fa fa-instagram" aria-hidden="true"></i><span>Instagram</span></a>
            </li>
            <li>
                <a href="https://play.google.com/store/apps/developer?id=Mirko+Mantovani"><i class="fa fa-android" aria-hidden="true"></i><span>PlayStore</span></a>
            </li>
            <li>
                <a href="https://github.com/mirkomantovani"><i class="fa fa-github" aria-hidden="true"></i><span>GitHub</span></a>
            </li>
        </ul>
        <!-- end home-social -->

    </section> <!-- end s-home -->


    <!-- about
    ================================================== -->
    <section id='about' class="s-about">





        <div class="row section-header has-bottom-sep" data-aos="fade-up">
            <div class="col-full">
                <h3 class="subhead subhead--dark">About</h3>
                <h1 class="display-1 display-1--light">Chicago Real-Time Air Quality, Visualization and Visual Analytics</h1>
            </div>
        </div> <!-- end section-header -->

        <div class="row about-desc" data-aos="fade-up">
            <div class="col-full">
                <p>
                    <h2>Introduction</h2>
                    This is the third project documentation for the CS 424 Visualization and Visual Analytics class at UIC. It consists in Chicago real-time air quality and weather data visualizations in an interactive web application created using the Shiny R library.

                    <br><br>

                    <h2>Authors</h2>
                    <a href="https://mmanto2.people.uic.edu/" style="color: darkblue">Mirko Mantovani</a><br>
                    <a href="https://avasud8.people.uic.edu/" style="color: darkblue">Abhishek Vasudevan</a><br>
                    <a href="https://ashwanikhemani.github.io/" style="color: darkblue">Ashwani Khemani</a>

                    <h2>Application , data , code</h2>

                    <a href="https://github.com/mirkomantovani/Chicago-RealTime-AQ" style="text-decoration: underline">Go to Github Repository</a><br>


                    <a href="" style="text-decoration: underline">Access the Shiny application on a
                    local Shiny server</a>
            </div>
        </div> <!-- end about-desc -->

        <div class="about__line"></div>

    </section> <!-- end s-about -->




    <section id="articles" class="s-clients">

<!--        CONTENT-->
<!--

        <div class="row about-desc" data-aos="fade-up">
            <div class="col-full">

                <h1 class="display-2">How to run the application</h1>
                <h2>Accessing the web application online</h2>
                <p>
                    Just click on the provided link to access the web application hosted on the EVL server from your browser. It is recommended to use a recent version of Google Chrome.

                </p>
                <h2>Hosting the web application locally</h2>

                Clone the project repository. Open app.R with RStudio, download <a href="https://www.rstudio.com/" style="text-decoration: underline">RStudio</a> and <a href="https://www.r-project.org/" style="text-decoration: underline">R</a> if you don't have them installed on your machine. Download all the R libraries used in the project executing the command install.packages("library") in the RStudio console. The application needs the data from the EPA website to be converted in to R data objects for better performance. The data required for the application can be downloaded from the data link provided at the start of the page. Please follow the below steps to do the required preprocessing before running the application to generate the data again.
                <ul>
                  <li>There are 4 preprocessing required to generate the necessary data files for the application:<h4> dataRead.R, preProcess.R,
                  preprocess_hourly_italy.R, preprocess_daily_italy.R </h4></li>
                  <li>The first two files dataRead.R and preProcess.R are used to download the data from the US EPA website and convert the data files into fst.
                  The dataRead.R needs to be run to download the files first. This will download all the files and unzip them into a "data" folder.
                  Run this script from the root directory of the project.
                  </li>
                  <li>Now, run the preProcess.R script from the root directory to convert the data files into fst format. These files would be generated
                  in a new folder "fst" in the project folder. This script might take some time to complete</li>
                  <li> The CSV files containing pollutant data for italy are already available in the GitHub repository in the project folder. We need to convert this to the fst format for the app to run. To achieve this, run the preprocess_daily_italy.R and preprocess_hourly_italy.R scripts from the root directory
                  and this will generate the fst files inside the italy folder. Note the fst files for italy are also already provided in the project italy folder.
                  </li>
                </ul>
                  Once we have all the neceessary data/fst files , we can now proceed with running of the application.
                Run the application via RStudio by clicking Run App at the top right on the main RStudio panel. Access it using a browser and with the local machine address and port on which the application is started. (<a href="http://127.0.0.1:port_num/" style="text-decoration: underline">http://127.0.0.1:6676/</a>)
                <br><br>

                <h1 class="display-2">Functionalities</h1>

                <h2>Getting started and Sidebar</h2>

                The application starts in full screen. You can open the menu items for different categories in the sidebar to see more options. The inputs item helps the user to switch between metric or imperial units for the whole application.

                <h2>Yearly visualizations: Yearly trends</h2>
                This first tab shows AQI and pollutants time series.


                The left box contains various inputs that allow interactivity with the plots. You can choose the color of the plot background, choose the county from an alphabetically ordered list of (County - State) pairs, select a range of years in which you want to concentrate.

                <div class="testimonials__slide">
                    <div class="testimonials__info">
                    </div>
                    <img src="/images/p2viz/1.png" alt="Screen" class="responsive">
                </div>

                By clicking on the settings button you can also change the grid and text colors in the plots to black, if the background color is too bright. In addition, you can change the colors for the pollutants for the second plot.

                <div class="testimonials__slide">
                    <div class="testimonials__info">
                    </div>
                    <img src="/images/p2viz/2.png" alt="Screen" class="responsive">
                </div>

                <div class="testimonials__slide">
                    <div class="testimonials__info">
                    </div>
                    <img src="/images/p2viz/3.png" alt="Screen" class="responsive">
                </div>

                <br>
                The first plot in the first tab shows AQI statistics over time. The second tabs contains a time series plot of the percentages of days as main pollutant and a table with those percentages.

                The third tab is a map showing the location of the selected county on the map, and showing all the counties in the US that highlights in white when you hover over them.

                <h2>Yearly visualizations: Year details for County</h2>

                The main panel is divided into two boxes, the one of the left shows AQI (Air Quality Index) levels. It consists in: a pie chart showing the percentages (sometimes estimated if there are missing data) of days with a certain level of AQI in a specific year for the selected County. Under this pie chart there is a bar chart and a table, both showing the number of days in the year with that level.
                <br>
                The right box, instead, shows detected pollutants data. The first tab in this box shows a pie chart for each pollutant with the percentage of days in which that pollutant was the main cause of problems. The second tab shows a bar chart with the number of days in which they were the main pollutant in that year. Again, the table at the bottom shows the same thing as the bar chart but in a different way.

                <div class="testimonials__slide">
                    <div class="testimonials__info">
                    </div>
                    <img src="/images/p2viz/4.png" alt="Screen" class="responsive">
                </div>

                <h2>Daily AQI</h2>
                This panel allows the user to visualize daily AQI trends for the selected year for all six pollutants : Ozone, SO2, CO, NO2, PM2.5, PM10. The left box allows the user to select a particular county from a list of alphabetically sorted counties in the US. The user can also choose the year for which the AQI data is to be displayed using the slider in the left panel. There are three visualizations available for daily AQI: One is the line graph which shows the AQI values over all days for selected year. The color of the points shows which pollutant had the highest value for that day. The user can click on any point on the line graph which would display a tooltip showing the date for that point, AQI value and major pollutant for that date.
                <div class="testimonials__slide">
                    <div class="testimonials__info">
                    </div>
                    <img src="/images/p2viz/daily_line.png" alt="Screen" class="responsive">
                </div>
                 The second visualization is the stacked bar chart which shows the number of days of each AQI category for all 12 months in the selected year. Different shades of grayscale indicate the AQI category as shown in the legend.
                 <div class="testimonials__slide">
                     <div class="testimonials__info">
                     </div>
                     <img src="/images/p2viz/daily_bar.png" alt="Screen" class="responsive">
                 </div>
                The third visualization is the table which similar to the bar chart shows the number of days of each AQI category for all 12 months in the selected year. The user can also see the daily trends for the top 12 counties in the US by making use of the switch button provided in the left box.
                <div class="testimonials__slide">
                    <div class="testimonials__info">
                    </div>
                    <img src="/images/p2viz/daily_table.png" alt="Screen" class="responsive">
                </div>
                The conversion to imperial units can be made by using the inputs tab in the main panel.

                <h2>Hourly pollutants</h2>
                This panel allows the user to visualize the hourly data for the six pollutants Ozone, SO2, CO, NO2, PM2.5, PM10 along with
                wind speed and temperature. The left box allows the user to select a particular county from a list of alphabetically sorted counties in the US.
                The user can then select any particular day in a year 2018 and see hourly trends for the pollutants , wind speed and temperature.
                <h4>Data Selection Panel</h4>The user can now pick any subset or all of hourly Ozone, SO2, CO, NO2, PM2.5, PM10, wind,
                and temperature and see them as different lines on the same line chart by using the select checkboxes below. A tick mark shows a
                selection for the checkbox.The user can also see the hourly trends for the top 12 counties in the US by making use of the switch
                button provided in the left box.To change the units for the hourly data, the user can make of the switch to imperial units option in
                the Inputs section of the main sidebar.
                <h4>Legend and units</h4>The legend shows the mapping of data to color along with the units. Notice that you can change from imperial to
                metric units from the sidebar switch in the Inputs tab.

                <div class="testimonials__slide">
                    <div class="testimonials__info">
                    </div>
                    <img src="/images/p2viz/hourly_trends_us.png" alt="Screen" class="responsive">
                </div>

                <h2>Pollutants heatmap</h2>
                The interactive map allows the user to visualize a heatmap of all the counties of the US and a pollutant (or AQI). It is possible to see data for an entire year or change to daily data through the switch that can be found in one of the 2 input panels ("Time and Pollutant").

                <div class="testimonials__slide">
                    <div class="testimonials__info">
                    </div>
                    <img src="/images/p2viz/map1.png" alt="Screen" class="responsive">
                </div>

                <br>
                As the rest of the application, this map is responsive and particularly, it was created for the big wall of display that we have in the classroom (11520 by 3240 pixels). In order to allow a practical user experience in terms of the touch screen wall present in the classroom, the UI has been designed to work best in this configuration that is the one applied to this version of the application:
                <h4>Shown counties panel</h4>
                The shown counties panel is static and positioned in the bottom right corner together with the legend. This type of circular input slider was implemented thinking about a functional touch screen use. This is why the whole panel is static and the shiny input variable behind the scene is only updated after approximately half a second since the user started interacting with it. The user can also type in a number by clicking in the displayed number using a HW keyboard. An additional input is present in this panel: a confidence level slider which allows the user to control if showing the counties with less data, thus less confidence in the computed percentages, with less opacity (towards 0) or to show all with the same opacity (towards 1).

                <div class="testimonials__slide">
                    <div class="testimonials__info">
                    </div>
                    <img src="/images/p2viz/countiespanel.png" alt="Screen" class="responsive">
                </div>

                <h4>Time and Pollutant panel</h4>
                The second panel that controls the Time and Pollutant inputs is dynamic, users can drag and drop it wherever they want in the map. This is useful when the screen is very large and the users would have to move by a few steps just to reach this panel and change the input. The inputs present in this panel are: Pollutant and AQI (if yearly data), switch to yearly/daily data, choose year for yearly data, choose month and day for daily data (only the year 2018 is available).

                <div class="testimonials__slide">
                    <div class="testimonials__info">
                    </div>
                    <img src="/images/p2viz/timepanel.png" alt="Screen" class="responsive">
                </div>

                <h4>Legend, units and colors</h4>The legend shows the mapping of data range to color. Notice that you can change from imperial to metric units from the sidebar switch in the Inputs tab. The color scale is continuous, the palette used is Viridis, which uses a range of colors distinguishable by all types of color blind people.
                <h4>Map interactions</h4>

                The user can visualize the name of the County by hovering over any County.
                The user can visualize the name of the State and County, as well as the precise pollutant value, the percentage of available days (confidence level), the total days available and a link to the wikipedia page of that County by clicking on any County.
                <br>

                <div class="testimonials__slide">
                    <div class="testimonials__info">
                    </div>
                    <img src="/images/p2viz/map2.png" alt="Screen" class="responsive">
                </div>

                <h2>Italy: daily trends</h2>
                This panel allows the user to visualize the daily pollutant value line graph for italy for the six pollutants: Ozone, SO2, CO, NO2, PM2.5, PM10. The left panel allows the user to choose any italian city for which data is available. The line graph shows a different colored line for each pollutant. The x-axis denotes the date and the y-axis is the pollutant value. The user can visualize select pollutants by turning off the other pollutants in the checkboxes given below the graph. The user can also click on points which would display a tooltip showing the exact date for that point.

                <div class="testimonials__slide">
                    <div class="testimonials__info">
                    </div>
                    <img src="/images/p2viz/daily_line_italy.png" alt="Screen" class="responsive">
                </div>
                The conversion to imperial units can be made by using the inputs tab in the main panel. By default, the dataset contains all pollutants in the ug/m3 unit. By switching to imperial, the units are converted to the (e-12 oz/ft3) unit.
                <h2>Italy: hourly trends</h2>
                This panel allows the user to visualize the hourly data of Italy over the period of 90 days (9 December - 8 March 2019) for the six pollutants
                Ozone, SO2, CO, NO2, PM2.5, PM10.The left box allows the user to select a particular city from a list of alphabetically sorted counties
                in Italy.The user can then select any particular day for the given period and see hourly trends for the pollutants.
                <h4>Data Selection Panel</h4>
                The user can now pick any subset or all of hourly Ozone, SO2, CO, NO2, PM2.5, PM10, and see them as different lines on the same
                line chart by using the select checkboxes below.
                A tick mark shows a selection for the checkbox. To change the units for the hourly data, the user can make of the switch to imperial
                units option in the Inputs section of the main side bar.
                <h4>Legend and units</h4>
                The legend shows the mapping of data to color along with the units. Notice that you can change from imperial to metric units
                from the sidebar switch in the Inputs tab.

                <div class="testimonials__slide">
                    <div class="testimonials__info">
                    </div>
                    <img src="/images/p2viz/hourly_trends_italy.png" alt="Screen" class="responsive">
                </div>

                <h2>Italy: Totals over 90 days</h2>
                This panel allows the user to visualize the average value of pollutants of any selected city in Italy in the date range between December 8,2018 to March 9, 2019. The left panel allows the user to choose any city in Italy. The bar chart shows the average values of each of the 6 pollutants. A checkbox given at the bottom can be used to deselect pollutants from being displayed on the bar chart. The way the average was calculated is as follows: For a given pollutant, its values for all days was added and divided by the total number of days. If the pollutant has values only for 30 days, its summed value over 30 days is divided by 30. In this way, the user is able to understand which pollutant is more rampant in a particular city.

                <div class="testimonials__slide">
                    <div class="testimonials__info">
                    </div>
                    <img src="/images/p2viz/italy_totals.png" alt="Screen" class="responsive">
                </div>


                <h1 class="display-2">Data, libraries and implementation</h1>

                <h2>Data</h2>
                The data for the application was downloaded from the following sources:<br>
                <a href='https://aqs.epa.gov/aqsweb/airdata/download_files.html'>United States Environmental Protection Agency</a><br>
                <a href='https://openaq.org/'>OpenAQ</a><br>
                <a href='http://eric.clst.org/tech/usgeojson/e'>United States Counties shape in GeoJSON</a>
                <br>
                <br>

                More information about how to download data and preprocessing is present in <h4>"How to run the application" tab and "Preprocessing" tab under
                "Problems during the development"</h4>

                <h2>Missing data</h2>
                The missing dataset presents some missing data for some specific years and counties, this was handled by warning the user with an alert message whenever he selects this type of data.

                <div class="testimonials__slide">
                    <div class="testimonials__info">
                    </div>
                    <img src="/images/p2viz/alert.png" alt="Screen" class="responsive">
                </div>

                <h2>Units of measure</h2>
                To allow users from both the United States and the rest of the world to give a meaning to all of this data we provided a practical switch on the sidebar under the inputs tabs so that the User can choose to convert data from Metric to Imperial and viceversa.

                <div class="testimonials__slide">
                    <div class="testimonials__info">
                    </div>
                    <img src="/images/p2viz/convert.png" alt="Screen" class="responsive">
                </div>

                <h2>Used R libraries</h2>
                This is the list of R libraries used for this project:

                <ul>
                    <li>shiny</li>
                    <li>shinydashboard</li>
                    <li>ggplot2</li>
                    <li>scales</li>
                    <li>shinythemes</li>
                    <li>dashboardthemes</li>
                    <li>ggthemes</li>
                    <li>shinyalert</li>
                    <li>leaflet</li>
                    <li>rgdal</li>
                    <li>geojson</li>
                    <li>geojsonio</li>
                    <li>colourpicker</li>
                    <li>shinyWidgets</li>
                    <li>viridis</li>
                    <li>cdlTools</li>
                    <li>htmltools</li>
                    <li>plotly</li>
                    <li>RColorBrewer</li>
                    <li>reshape2</li>
                    <li>fst</li>
                    <li>future</li>
                    <li>data.table</li>
                    <li>ggvis</li>




                </ul>

                <h2>Problems during the development</h2>
                Data size and slow loading problem<br><br>
                One of the challenges we faced while deveoping this application was that the size of the dataset was big (around 7-8 GB) as we were
                dealing with yearly,daily and hourly data.
                <h4>Preprocessing</h4>
                To make the size of the dataset managable and make our application efficient in terms of memory and response time, we performed preprocessing
                on the dataset downloaded from the EPA website.This was done in an automated manner by running a single script before running the application.
                Please note that as we are dealing with very large file sizes here, the preprocessing could take some considerable time to complete.
                There are two scripts used for preprocessing. One is used to download the data files for the US(dataRead.R)and the other to perform
                preprocessing operation on the downloaded data(preProcess.R). The preprocessing scripts in the application performs the following operations:
                <ul>
                    <li>Download the relevant data required for the application from the EPA website. This is done by data read script
                    provided in the application</li>
                    <li>Create three output files one each for Daily AQI data, Daily all pollutants data and Hourly data for pollutants,wind and temperature</li>
                    <li>To read the various data files provided by the EPA, we make of data read function which can read the data in a fast manner.
                    We make use of fread() function provided by R to read the very large files and make the reading process more efficient.
                    </li>
                    <li>To reduce the size of the dataset we make use of one of R data object (fst). You can read more about it
                    <a href="https://www.fstpackage.org/"><i aria-hidden="true"></i>here</a>
                    .The decision to make use of this package was made after performing experiments with various R data objects like rds,rda,feather,etc
                    and performing benchmarking on those and checking the performane of the application based on memory usage and response time.</li>
                    <li>Selection of relevant columns is done from the various data files so that only those columns which are relevant for visualizations
                    are provided and read in the application.
                    </li>
                    <li>The columns selected for daily AQI data are: "State Name","County Name","AQI","Category","Defining Parameter","Year","Month","Day". </li>
                    <li>The columns selected for hourly data are: "State Name","County Name","SO2","CO","NO2","Ozone","PM2.5","PM10","Wind Direction",
                    "Wind Speed","Temperature","Year","Month","Day".</li>
                    <li>The columns selected for daily pollutants data are "State Name","County Name","SO2","CO","NO2","Ozone","PM2.5","PM10","Year",
                    "Month","Day".</li>
                    <li>Aggregation is performed for data which siginify the same values by taking average for such values. For e.g
                    Values for pollutants are averaged across multiple sites in a county, multiple monitors at the same site,etc.
                    </li>
                    <li>To reduce the number of files and have all data for a particular type namely daily AQI, hourly data, daily pollutant data,
                    merging of datasets was done for various pollutants, wind, temperature whenever possible. Special attention is paid to not lose data if
                    one of the parameter is not available and others are during the merge process.
                    </li>
                    <li>The date provided in the dataset is further split in individual components of day, month , year to avoid computations during the
                    running of the application.
                    </li>
                </ul>
                <h4>Preprocessing for Italy pollutant files</h4>
                The preprocessing for Italy is straightforward compared to the USA.
                <ul>
                    <li>Download the CSV data (already available in github repository) for past 90 days for each of Italy's cities using the API provided by EPA.</li>
                    <li>Two preprocessing scripts are used to generate fst files for italy: one is the daily data script and other is the hourly data script.</li>
                    <li>The CSV files contain hourly data. The hourly preprocessing script gets rid of unwanted columns in the data and converts the data frames into fst format.</li>
                    <li>The daily preprocessing script creates a new dataframe containing data of each pollutant for each day. Since the CSV files contain only hourly data, the pollutant value for a particular day is found by averaging the pollutant values over 24 hours for that day.</li>
                    <li>There are 45 Italian cities in total. Each city has several locations from which data is obtained for the same day. The pollutant value for a particular city is found by averaging the pollutant values for all locations of that city.</li>
                </ul>
                <h4>High application start up time</h4>
                To make the application load time faster, we make use of futures to delay the load of data file like json files for maps. This was
                done by making us the futures functionality provided by R and loading the data only when the data is required by the application.
                This along with making of special R object files(fst) made the application more responsive even for the big dataset used.
                <br><br>

                <h1 class="display-2">Interesting Insights</h1>

                <h2>Overall AQI comparison 20 years ago and now</h2>
                From the heatmap it seems that the overall AQI in the US has sligthly improved over the past 20 years. I would say the average AQI over all the states in 2018 was around 40 while 20 years ago it was maybe closer to 50. Moreover, it looks like the AQI is more uniform nowadays than it was in the past.

                <div class="row clients-testimonials" data-aos="fade-up">
                    <div class="col-full">
                        <div class="testimonials">


                            <div class="testimonials__slide">
                                <div class="testimonials__info">
                                    <span class="testimonials__name">AQI 1998</span>
                                </div>
                                <br><br>
                                <img src="/images/p2viz/interesting1.png" alt="Screen" class="responsive">
                                <br><br>
                            </div>

                            <div class="testimonials__slide">
                                <div class="testimonials__info">
                                    <span class="testimonials__name">AQI 2018</span>
                                </div>
                                <br><br>
                                <img src="/images/p2viz/interesting2.png" alt="Screen" class="responsive">
                                <br><br>
                            </div>

                        </div>

                    </div>
                </div>


                <h2>PM2.5 comparison 20 years ago and now</h2>
                PM2.5 is one of the new emerging and problematic pollutants, as we can see, in 20 years, a lot of counties passed from never having the PM2.5 as main pollutant during the year, to having it as most pollutant for every day of the year. We can also notice how, except the big cities in the coasts, the difference between neighboring counties is sharp and not graded, suggesting that the problem is local and that the pollutant is unlikely to spread far from where it is originated.
                <div class="row clients-testimonials" data-aos="fade-up">
                    <div class="col-full">
                        <div class="testimonials">


                            <div class="testimonials__slide">
                                <div class="testimonials__info">
                                    <span class="testimonials__name">PM2.5 % of days as main pollutant in 1998</span>
                                </div>
                                <br><br>
                                <img src="/images/p2viz/interesting3.png" alt="Screen" class="responsive">
                                <br><br>
                            </div>

                            <div class="testimonials__slide">
                                <div class="testimonials__info">
                                    <span class="testimonials__name">PM2.5 % of days as main pollutant in 2018</span>
                                </div>
                                <br><br>
                                <img src="/images/p2viz/interesting4.png" alt="Screen" class="responsive">
                                <br><br>
                            </div>

                        </div>

                    </div>
                </div>
                <h2>Urban CO pollution in Italy </h2>
                Carbon Monoxide levels in urban areas are significantly high in comparison with other pollutants. In contrast, the CO levels in rural areas like Alfonsine are non-existent. Carbon Monoxide in urban areas is high due to more vehicular emissions.
                <div class="row clients-testimonials" data-aos="fade-up">
                    <div class="col-full">
                        <div class="testimonials">


                            <div class="testimonials__slide">
                                <div class="testimonials__info">
                                    <span class="testimonials__name">Average pollutants value in Rome (Urban)</span>
                                </div>
                                <br><br>
                                <img src="/images/p2viz/rome_co_trend.png" alt="Screen" class="responsive">
                                <br><br>
                            </div>

                            <div class="testimonials__slide">
                                <div class="testimonials__info">
                                    <span class="testimonials__name">Average pollutants value in Alfonsine (Rural)</span>
                                </div>
                                <br><br>
                                <img src="/images/p2viz/alfonsine_co_trend.png" alt="Screen" class="responsive">
                                <br><br>
                            </div>

                        </div>

                    </div>
                </div>
                <h2>Volanic activity in Hawaii</h2>
                Due to high levels of volanic activity in Hawaii, there is a high level of SO2 in the island throughout the year.
                <div class="testimonials__slide">
                    <div class="testimonials__info">
                    </div>
                    <img src="/images/p2viz/hawaii_so2_trend.png" alt="Screen" class="responsive">
                </div>

                <h2>Cleanest air in the USA</h2>
                Chittenden county in Vermont is supposed to have one of the cleanest air in the US devoid of air pollution. This is confirmed from the daily AQI bar chart as shown in image below where the AQI category is good for most of the days.
                <div class="testimonials__slide">
                    <div class="testimonials__info">
                    </div>
                    <img src="/images/p2viz/chittenden.png" alt="Screen" class="responsive">
                </div>

                <h2>Hourly Data - US </h2>
                The particulate matter values(PM10/PM2.5) and Ozone are usually high during the day time or late night
                as compared to evening.Carbon monoxide (CO)
                and Nitrogen Ozide (NO2) have compartively high values in the evening as compared to afternoon. The temperature are low during
                the night and early morning hours and peak around during the afternoon and gradually decreasing in the evening.
                The temperatures follow seasonal trends, are high in summer months as compared to fall and winter.
                The wind speed is generally more during the day time as compared to night and early morning hours.
                <div class="row clients-testimonials" data-aos="fade-up">
                    <div class="col-full">
                        <div class="testimonials">


                            <div class="testimonials__slide">
                                <div class="testimonials__info">
                                    <span class="testimonials__name">PM values</span>
                                </div>
                                <br><br>
                                <img src="/images/p2viz/hourly_insight_1.png" alt="Screen" class="responsive">
                                <br><br>
                            </div>

                            <div class="testimonials__slide">
                                <div class="testimonials__info">
                                    <span class="testimonials__name">Wind - Temperature</span>
                                </div>
                                <br><br>
                                <img src="/images/p2viz/hourly_insight_2.png" alt="Screen" class="responsive">
                                <br><br>
                            </div>
                            <div class="testimonials__slide">
                                <div class="testimonials__info">
                                    <span class="testimonials__name">CO/NO2/Ozone</span>
                                </div>
                                <br><br>
                                <img src="/images/p2viz/hourly_insight_3.png" alt="Screen" class="responsive">
                                <br><br>
                            </div>

                        </div>
                      </div>
                    </div>
                <h2>Hourly Data - Italy </h2>
                Carbon monoxide (CO) and Nitrogen Ozide (NO2) have generally high values in the evening and early morning hours as compared to afternoon.
                The Ozone value are generally high during night time with some exceptions as compared to day time.
                <div class="row clients-testimonials" data-aos="fade-up">
                    <div class="col-full">
                        <div class="testimonials">


                            <div class="testimonials__slide">
                                <div class="testimonials__info">
                                    <span class="testimonials__name">Ozone</span>
                                </div>
                                <br><br>
                                <img src="/images/p2viz/hourly_insight_4.png" alt="Screen" class="responsive">
                                <br><br>
                            </div>

                            <div class="testimonials__slide">
                                <div class="testimonials__info">
                                    <span class="testimonials__name">CO and NO2</span>
                                </div>
                                <br><br>
                                <img src="/images/p2viz/hourly_insight_5.png" alt="Screen" class="responsive">
                                <br><br>
                            </div>
                        </div>
                    </div>
                </div>


                <h2>Some screenshots of the app on the big wall</h2>
                <div class="row clients-testimonials" data-aos="fade-up">
                    <div class="col-full">
                        <div class="testimonials">


                            <div class="testimonials__slide">
                                <div class="testimonials__info">
                                    <span class="testimonials__name">Map</span>
                                </div>
                                <br><br>
                                <img src="/images/p2viz/wall1.png" alt="Screen" class="responsive">
                                <br><br>
                            </div>

                            <div class="testimonials__slide">
                                <div class="testimonials__info">
                                    <span class="testimonials__name">Map zoomed</span>
                                </div>
                                <br><br>
                                <img src="/images/p2viz/wall2.png" alt="Screen" class="responsive">
                                <br><br>
                            </div>
                            <div class="testimonials__slide">
                                <div class="testimonials__info">
                                    <span class="testimonials__name">Line Chart</span>
                                </div>
                                <br><br>
                                <img src="/images/p2viz/wall3.png" alt="Screen" class="responsive">
                                <br><br>
                            </div>
                        </div>
                    </div>
                </div>


            </div>
        </div>
-->



        <section id="articles" class="s-clients">

            <div class="row about-desc" data-aos="fade-up">
                <div class="col-full">

                    <!-- Templates:
                     Picture:
                        <img src="/images/p2viz/pic_name.png" alt="Screen" class="responsive">
                -->

                    <h1 class="display-2">Weekly Updates on progress</h1>
                    <h1 style="font-size: 32pt">Week 1</h1>
                    <h2>Mirko</h2>
                    For the first week I started my work by designing the initial high-level Graphical User Interface with sidebar, tabs, colors. I then concentrated on the Array of Things APIs. I integrated useful functions that we would need in our project inspired by the official R wrapper APIs that are currently not working. I noticed that there were a few problems in the AoT APIs, and with the queries that they provide it is tricky to get the initial information that we need for the map (dataset with all the nodes and the sensor that each node provides). Since right now there is no trivial way (apparently) to get the sensors list from a node, I got the same information parsing the observations of each individual node, this process is slow due to the need of querying each node and slow response from the AoT servers, it takes approximately 30 seconds. Once I created the needed dataset I noticed some interesting problems: only 38 nodes currently responde with data observations (the toal number of nodes already deployed is 119). Also, I cannot explain why 2 nodes with different vsn (070 and 072) have same exact location and address. I then plotted on the map the locations of the sensors and created the selection layers for the users, where they can select to visualize only part a subset of sensors.
                    I saved the nodes information in FST format and created a variable that controls the update of the nodes information or retrieves the previously saved one. I also created a basic plot and the comparison for the Current data and all of the tracked measures coming from the AoT source: when clicking on a node the plot is displayed for the selected measures, the user can also select another node and compare it two the previous one by visualizing an identical plot below the most recent's one.

                    <h2>Abhishek</h2>
                    Started working on preprocessing the OpenAQ data. Task is to bring it  to a certain dataframe format, so that reading it becomes easy.
                    <h2>Ashwani</h2>
                    During this week, I tried working with the R library for AoT and contacted the owner of repository for a fix for the recent changes.
                    We then moved forward with using the AoT API directly. We discussed about the various project requirements and how to implement them.
                    I worked on creating some of the graphical charts for the Array of Things data and added corresponding units of measure for them.


                    <h1 style="font-size: 32pt">Week 2</h1>
                    <h2>Mirko</h2>
                    If I thought the Array of Things data source was bad from the first week impressions, now I can confirm this is the worst APIs and service I've ever used. The challenges I faced this week were related to showing the last 24 hours and last 7 days of data in a line chart upon clicking on a sensor. I discovered that a lot of sensor that have data, randomly shut down and turn back on disrupting the service and making it difficult to understand what is going on with the data. I had trouble in finding a node which was pretty good in terms of providing data constantly, eventually I picked node 08D. The issue now was on how to query the APIs to get the data I wanted. I initially tried to get all the observations in the last 24 hours and then preprocess them. I soon realized the infeasibility of this method because of the latency in downloading and preprocessing such a large quantity of data (around 100k rows) in real-time. It would take around 1 minute from when the user clicks the node to when the plot is generated. Way too much. I thought about a possible implementation in which data for each node are preloaded and processed when the application starts but that would take too much time and the user expects reactivity quickly. My final solution to solve this problem was that of subsampling the data (200 obs each hour/day) based on the timestamp. It also took me a long time to figure out how to create an HTTP request to the AoT APIs filtering based on timestamp. The official APIs documentation as of now lacks examples or proper explanation. Eventually I got it to work. Another cool surprised AoT gave us is that there are places in Chicago with -30 ppm of so2, which would be great if it was true but I'm afraid it's not really physically possible.


                    <h2>Abhishek</h2>
                    Done with the preprocessing script for openAQ data. Need to start working on creating 4 new tabs for displaying graph and tables for two subsets of data identified during our discussion. 
                    <h2>Ashwani</h2>
                    During this week, I created the table for node and sensor information for Array of Things dataset. I then worked on the tabular visualzation for Darksky for the current time in a separte panel. The functionality to filter sites based on measures was added for the table representation of the sites. The graphical charts for Array of Things now can take input from the table and show corresponding visualizations. The selection of multiple inputs from table is a bit tricky and needs to be looked into in detail for the comparsion task.

<!--

                    <h1 style="font-size: 32pt">Alpha version</h1>
                    <h2>Mirko</h2>
                    Completed A part: The map UI was improved allowing the user to switch back and forth between the daily heatmap and yearly visualizations. When the daily heatmap is selected, the Month and Day input for the year 2018 are shown, the pollutants choice is also modified and AQI is removed from the dropdown list because of the lack of the corresponding column in the daily data. I also decided to adopt a more user-friendly widget for the county number input, using a circular input in a fixed panel at the bottom right of the screen.

                    <h2>Abhishek</h2>
                    Completed daily data visualizations given in part C. Should continue improvising this by better data loading methods to make the app boot up faster.

                    <h2>Ashwani</h2>
                    During this week, I did preprocessing for the hourly wind and temperature data and get them in R object format. I created a single data file for all the yearly AQI data to make the loading of the data faster in the application. I completed the creation of all the hourly line charts for pollutants, wind and temperature and allowing user to pick any of the plots for analysis.



                    <h1 style="font-size: 32pt">Week 3</h1>
                    <h2>Mirko</h2>
                    Changed UI sidebar. Added convert to metric input and handled conversion to metric units for pollutants map.


                    <h2>Abhishek</h2>
                    Worked on preprocessing daily and hourly data for italy (Graduate student's requirements). Started working on the UI for displaying these data on the shiny app.

                    <h2>Ashwani</h2>
                    During this week, I experimented and benchkmarked various R data objects formats to make our reading of data more efficient both in time and memory. I made use of futures to delay the load of data to the time when required. I also stated working on adding the feature of imperial units for hourly data. Hourly data plots were modified to display default plots and wind direction plot was removed.


                    <h1 style="font-size: 32pt">Week 4</h1>
                    <h2>Mirko</h2>
                    No scrolling is possible in the application. Modified panels for map. Added confidence input in map and modified color opacity based on days with data in map. Minor fixes to colors and sizes for Yearly plots.

                    <h2>Abhishek</h2>
                    Completed the daily and totals for italy. Made several minor bug fixes. Added imperial conversion for daily AQI for both USA and italy. Implemented touch feature for ggvis plots.
                    <h2>Ashwani</h2>
                    Metric to imperial conversion for hourly plots for US. Worked on creation of hourly charts for one more country Italy.Added switch for
                    top 12 counties in US. Updated the hourly preprocessing script for italy for performance. Minor fixes for yearly plots.
-->

                </div>
            </div>

        </section>

        <style>
            .marginauto {
                            margin: 10px auto 20px;
                            display: block;
                            }
                        </style>

        <!-- services
    ================================================== -->

        <!-- works
    ================================================== -->
        <section id='video' class="s-works">

            <div class="intro-wrap">


                <div class="row section-header has-bottom-sep light-sep" data-aos="fade-up">
                    <div class="col-full">
                        <h3 class="subhead">Video</h3>
                        <h1 class="display-2 display-2--light">Video presentation</h1>

<!--                        <iframe width="1080" height="720" src="https://www.youtube.com/embed/UCvc0h6yKMg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>-->

                    </div>
                </div>
                <div class="row works-content">
                    <div class="col-full masonry-wrap">
                        <div class="masonry">


                        </div>
                    </div>
                </div>
            </div>

        </section>



        <!-- contact
    ================================================== -->
        <section id="contact" class="s-contact">

            <div class="overlay"></div>
            <div class="contact__line"></div>

            <div class="row section-header" data-aos="fade-up">
                <div class="col-full">
                    <h3 class="subhead">Contact Us</h3>
                    <h1 class="display-2 display-2--light">Reach out for a new project or just say hello</h1>
                </div>
            </div>

            <div class="row contact-content" data-aos="fade-up">

                <div class="contact-primary">

                    <h3 class="h6">Send Me A Message</h3>

                    <form name="contactForm" id="contactForm" method="post" action="" novalidate="novalidate">
                        <fieldset>

                            <div class="form-field">
                                <input name="contactName" type="text" id="contactName" placeholder="Your Name" value="" minlength="2" required="" aria-required="true" class="full-width">
                            </div>
                            <div class="form-field">
                                <input name="contactEmail" type="email" id="contactEmail" placeholder="Your Email" value="" required="" aria-required="true" class="full-width">
                            </div>
                            <div class="form-field">
                                <input name="contactSubject" type="text" id="contactSubject" placeholder="Subject" value="" class="full-width">
                            </div>
                            <div class="form-field">
                                <textarea name="contactMessage" id="contactMessage" placeholder="Your Message" rows="10" cols="50" required="" aria-required="true" class="full-width"></textarea>
                            </div>
                            <div class="form-field">
                                <button class="full-width btn--primary">Submit</button>
                                <div class="submit-loader">
                                    <div class="text-loader">Sending...</div>
                                    <div class="s-loader">
                                        <div class="bounce1"></div>
                                        <div class="bounce2"></div>
                                        <div class="bounce3"></div>
                                    </div>
                                </div>
                            </div>

                        </fieldset>
                    </form>

                    <!-- contact-warning -->
                    <div class="message-warning">
                        Something went wrong. Please try again.
                    </div>

                    <!-- contact-success -->
                    <div class="message-success">
                        Your message was sent, thank you!<br>
                    </div>

                </div> <!-- end contact-primary -->

                <div class="contact-secondary">
                    <div class="contact-info">

                        <h3 class="h6 hide-on-fullwidth">Contact Info</h3>

                        <div class="cinfo">
                            <h5>Where I live</h5>
                            <p>
                                Chicago, IL<br>
                                60622 USA
                            </p>
                        </div>

                        <div class="cinfo">
                            <h5>Email Me At</h5>
                            <p>
                                mrk23 at hotmail dot it<br>

                            </p>
                        </div>

                        <div class="cinfo">
                            <h5>Call Me At</h5>
                            <p>

                                Mobile: <br>

                            </p>
                        </div>

                        <ul class="contact-social">
                            <li>
                                <a href="https://www.facebook.com/mrkmantovani"><i class="fa fa-facebook" aria-hidden="true"></i></a>
                            </li>
                            <li>
                                <a href="https://www.linkedin.com/in/mirkomantovani/"><i class="fa fa-linkedin" aria-hidden="true"></i></a>
                            </li>
                            <li>
                                <a href="https://www.instagram.com/mirkomantovani/"><i class="fa fa-instagram" aria-hidden="true"></i></a>
                            </li>
                            <li>
                                <a href="https://play.google.com/store/apps/developer?id=Mirko+Mantovani"><i class="fa fa-android" aria-hidden="true"></i></a>
                            </li>
                            <li>
                                <a href="https://github.com/mirkomantovani"><i class="fa fa-github" aria-hidden="true"></i></a>
                            </li>
                        </ul> <!-- end contact-social -->

                    </div> <!-- end contact-info -->
                </div> <!-- end contact-secondary -->

            </div> <!-- end contact-content -->

        </section> <!-- end s-contact -->


        <!-- footer
    ================================================== -->
        <footer>

            <div class="row footer-main">

                <div class="col-six tab-full left footer-desc">

                    <div class="footer-logo"></div>
                    Portfolio of Mirko Mantovani
                </div>

                <div class="col-six tab-full right footer-subscribe">

                    <h4>Get Notified</h4>
                    <p></p>

                    <div class="subscribe-form">
                        <form id="mc-form" class="group" novalidate="true">
                            <input type="email" value="" name="EMAIL" class="email" id="mc-email" placeholder="Email Address" required="">
                            <input type="submit" name="subscribe" value="Subscribe">
                            <label for="mc-email" class="subscribe-message"></label>
                        </form>
                    </div>

                </div>

            </div> <!-- end footer-main -->

            <div class="row footer-bottom">
                <!--
            <div class="col-twelve">
                <div class="copyright">
                    <span> Copyright Glint 2017</span>
                    <span>Site Template by <a href="">Colorlib</a></span>
                </div>

                <div class="go-top">
                    <a class="smoothscroll" title="Back to Top" href="#top"><i class="icon-arrow-up" aria-hidden="true"></i></a>
                </div>
            </div>
-->

            </div> <!-- end footer-bottom -->

        </footer> <!-- end footer -->


        <!-- photoswipe background
    ================================================== -->
        <div aria-hidden="true" class="pswp" role="dialog" tabindex="-1">

            <div class="pswp__bg"></div>
            <div class="pswp__scroll-wrap">

                <div class="pswp__container">
                    <div class="pswp__item"></div>
                    <div class="pswp__item"></div>
                    <div class="pswp__item"></div>
                </div>

                <div class="pswp__ui pswp__ui--hidden">
                    <div class="pswp__top-bar">
                        <div class="pswp__counter"></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button> <button class="pswp__button pswp__button--share" title="Share"></button> <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button> <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                        <div class="pswp__preloader">
                            <div class="pswp__preloader__icn">
                                <div class="pswp__preloader__cut">
                                    <div class="pswp__preloader__donut"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                        <div class="pswp__share-tooltip"></div>
                    </div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button> <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>
                    <div class="pswp__caption">
                        <div class="pswp__caption__center"></div>
                    </div>
                </div>

            </div>

        </div> <!-- end photoSwipe background -->


        <!-- preloader
    ================================================== -->
        <div id="preloader">
            <div id="loader">
                <div class="line-scale-pulse-out">
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                </div>
            </div>
        </div>


        <!-- Java Script
    ================================================== -->
        <script src="/js/jquery-3.2.1.min.js"></script>
        <script src="/js/plugins.js"></script>
        <script src="/js/main.js"></script>


</body>

</html>
